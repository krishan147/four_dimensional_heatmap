from pandas import Timestamp
import pandas as pd
import numpy as np
from ggplot import *
import matplotlib.pyplot as plt
from plotnine import *

df=pd.DataFrame({'Date':['01/03/2018', '11/10/2018', '11/10/2018', '01/02/2018', '01/05/2018', '01/10/2018', '21/11/2018', '01/06/2018', '11/10/2018', '01/09/2018', '01/11/2018', '01/10/2018', '21/11/2018', '11/10/2018', '11/10/2018', '01/07/2018', '01/11/2018', '01/12/2018', '01/08/2018', '01/10/2018', '01/11/2018', '01/07/2018', '01/02/2018', '01/04/2018', '01/01/2018', '01/07/2018', '11/10/2018', '01/02/2018', '01/06/2018', '01/05/2018', '01/05/2018', '01/05/2018', '01/01/2018', '01/12/2018', '11/10/2018', '01/12/2018', '01/06/2018', '01/04/2018', '01/02/2018', '01/04/2018', '11/10/2018', '01/11/2018', '21/11/2018', '01/10/2018', '01/09/2018', '01/08/2018', '01/06/2018', '01/01/2018', '21/11/2018', '01/03/2018', '01/03/2018', '01/08/2018', '01/04/2018', '01/09/2018', '01/12/2018', '01/08/2018', '01/03/2018', '01/01/2018', '01/09/2018', '01/07/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/11/2018', '01/04/2018', '01/09/2018', '01/05/2018', '01/04/2018', '01/03/2018', '01/06/2018', '01/02/2018', '01/02/2018', '01/09/2018', '01/08/2018', '01/08/2018', '11/10/2018', '01/10/2018', '01/06/2018', '11/10/2018', '21/11/2018', '01/07/2018', '01/10/2018', '01/12/2018', '01/11/2018', '11/10/2018', '21/11/2018', '01/07/2018', '01/01/2018', '01/03/2018', '11/10/2018', '01/12/2018', '01/01/2018', '01/05/2018','01/09/2018', '01/05/2018', '01/11/2018', '01/04/2018', '01/03/2018', '11/10/2018', '11/10/2018', '01/06/2018', '01/01/2018', '01/06/2018', '01/07/2018', '11/10/2018', '01/07/2018', '01/10/2018', '01/02/2018', '01/12/2018', '21/11/2018', '11/10/2018', '01/09/2018', '01/08/2018', '01/05/2018', '11/10/2018', '01/04/2018', '01/08/2018', '01/05/2018', '01/07/2018', '21/11/2018', '01/07/2018', '01/12/2018', '01/12/2018', '01/11/2018', '01/02/2018', '01/01/2018', '01/08/2018', '01/08/2018', '01/12/2018', '21/11/2018', '01/05/2018', '01/03/2018', '01/11/2018', '01/02/2018', '01/09/2018', '01/10/2018', '01/03/2018', '01/06/2018', '01/04/2018', '01/11/2018', '11/10/2018', '01/03/2018', '11/10/2018', '01/04/2018', '01/09/2018', '01/10/2018', '21/11/2018', '01/02/2018', '01/01/2018', '01/10/2018', '01/01/2018', '11/10/2018', '01/06/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/11/2018', '01/04/2018', '01/09/2018', '01/05/2018', '01/04/2018', '01/03/2018', '01/06/2018', '01/02/2018', '01/02/2018', '01/09/2018', '01/08/2018', '01/08/2018', '11/10/2018', '01/10/2018', '01/06/2018', '11/10/2018', '21/11/2018', '01/07/2018', '01/10/2018', '01/12/2018', '01/11/2018', '11/10/2018', '21/11/2018', '01/07/2018', '01/01/2018', '01/03/2018', '11/10/2018', '01/12/2018', '01/01/2018', '01/05/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/01/2018','01/02/2018','01/03/2018','01/04/2018','01/05/2018','01/06/2018','01/07/2018','01/08/2018','01/09/2018','01/10/2018','01/11/2018','01/12/2018','21/11/2018','11/10/2018','11/10/2018','01/03/2018', '21/11/2018', '01/06/2018', '01/06/2018', '01/09/2018', '11/10/2018', '01/01/2018', '01/11/2018', '01/01/2018', '01/09/2018', '01/03/2018', '01/05/2018', '01/08/2018', '11/10/2018', '01/07/2018', '01/11/2018', '01/08/2018', '01/12/2018', '01/02/2018', '11/10/2018', '01/10/2018', '01/02/2018', '01/04/2018', '01/10/2018', '01/05/2018', '01/07/2018', '01/12/2018', '11/10/2018', '01/04/2018', '21/11/2018'], 'Spend': [76, 123, 12, 34, 34, 34, 20, 43, 61, 33, 12, 42, 23, 53, 43, 53, 34, 123, 12, 76, 34, 54, 42, 23, 134, 43, 61, 42, 134, 42, 43, 123, 33, 43, 0, 12, 20, 32, 54, 24, 65, 34, 123, 26, 26, 65, 43, 54, 54, 43, 32, 0, 24, 12, 12, 234, 43, 23, 23, 234,76,43,123,43,234,54,34,12,43,54,65,23,12,32,0,26,43,123,23,134,34,24,42,53,34,61,33,42,12,20,26, 43, 32, 123, 20, 34, 12, 54, 34, 42, 53, 134, 43, 23, 54, 65, 34, 123, 12, 33, 0, 23, 43, 234, 24, 12, 42, 43, 61, 76,23, 54, 23, 43, 234, 32, 12, 20, 26, 134, 34, 33, 42, 123, 54, 54, 65, 42, 61, 24, 33, 42, 34, 54, 76, 43, 43, 12, 34, 32, 34, 12, 34, 123, 123, 53, 65, 53, 12, 20, 123, 234, 12, 0, 61, 23, 43, 24, 26, 43, 12, 43, 76, 134, 23, 34, 43, 43, 0, 42,76,43,123,43,234,54,34,12,43,54,65,23,12,32,0,26,43,123,23,134,34,24,42,53,34,61,33,42,12,20,26, 43, 32, 123, 20, 34, 12, 54, 34, 42, 53, 134, 43, 23, 54, 65, 34, 123, 12, 33, 0, 23, 43, 234, 24, 12, 42, 43, 61, 76,76,43,123,43,234,54,34,12,43,54,65,23,12,32,0,26,43,123,23,134,34,24,42,53,34,61,33,42,12,20,54, 43, 33, 23, 42, 76, 123, 23, 43, 12, 61, 54, 0, 43, 32, 12, 53, 42, 65, 134, 34, 34, 123, 43, 26, 12, 34, 20, 24, 234],
                 'Site': ['Amazon', 'Microsoft', 'Microsoft', 'Apple', 'Ikea', 'Microsoft', 'Ikea', 'Microsoft', 'Amazon', 'Sony', 'Amazon', 'Spotify', 'Amazon', 'Samsung', 'Ikea', 'Apple', 'Apple', 'Amazon', 'Amazon', 'Microsoft', 'Microsoft', 'Amazon', 'Ikea', 'Microsoft', 'Amazon', 'Ikea', 'Apple', 'Ikea', 'Apple', 'Ikea', 'Ikea', 'Spotify', 'Ikea', 'Ikea', 'Ikea', 'Apple', 'Amazon', 'Amazon', 'Amazon', 'Apple', 'Microsoft', 'Microsoft', 'Sony', 'Tesla', 'Apple', 'Amazon', 'Tesla', 'Microsoft', 'Microsoft', 'Amazon', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Apple', 'Ikea', 'Microsoft', 'Apple', 'Amazon', 'Samsung','Amazon', 'Apple', 'Amazon', 'Tesla', 'Amazon', 'Amazon', 'Ikea', 'Ikea', 'Apple', 'Microsoft', 'Ikea', 'Microsoft', 'Amazon', 'Microsoft', 'Sony', 'Amazon', 'Ikea', 'Apple', 'Apple', 'Ikea', 'Microsoft', 'Ikea', 'Spotify', 'Microsoft', 'Amazon', 'Amazon', 'Ikea', 'Apple', 'Microsoft', 'Samsung','Amazon','Ikea','Amazon','Ikea', 'Amazon', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Amazon', 'Ikea','Ikea','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Microsoft','Apple','Microsoft','Tesla','Spotify','Sony','Samsung','Ikea', 'Amazon', 'Microsoft', 'Microsoft', 'Amazon', 'Ikea', 'Apple', 'Sony', 'Tesla', 'Amazon', 'Spotify', 'Ikea', 'Microsoft', 'Apple', 'Spotify', 'Ikea', 'Ikea', 'Ikea', 'Apple', 'Microsoft', 'Ikea', 'Samsung', 'Microsoft', 'Microsoft', 'Ikea', 'Ikea', 'Apple', 'Apple', 'Amazon', 'Amazon', 'Microsoft', 'Amazon', 'Amazon', 'Microsoft', 'Microsoft', 'Ikea', 'Samsung', 'Amazon', 'Amazon', 'Tesla', 'Amazon', 'Amazon', 'Apple', 'Amazon', 'Amazon', 'Sony', 'Apple', 'Ikea', 'Microsoft', 'Amazon', 'Apple', 'Amazon', 'Microsoft', 'Ikea', 'Ikea', 'Apple', 'Microsoft', 'Ikea', 'Apple', 'Amazon','Amazon', 'Apple', 'Amazon', 'Tesla', 'Amazon', 'Amazon', 'Ikea', 'Ikea', 'Apple', 'Microsoft', 'Ikea', 'Microsoft', 'Amazon', 'Microsoft', 'Sony', 'Amazon', 'Ikea', 'Apple', 'Apple', 'Ikea', 'Microsoft', 'Ikea', 'Spotify', 'Microsoft', 'Amazon', 'Amazon', 'Ikea', 'Apple', 'Microsoft', 'Samsung','Amazon','Ikea','Amazon','Ikea', 'Amazon', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Amazon', 'Ikea','Ikea','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Microsoft','Apple','Microsoft','Tesla','Spotify','Sony','Samsung','Amazon','Ikea','Amazon','Ikea', 'Amazon', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Ikea', 'Amazon', 'Amazon', 'Ikea','Ikea','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Apple','Microsoft','Microsoft','Apple','Microsoft','Tesla','Spotify','Sony','Samsung','Ikea', 'Apple', 'Apple', 'Sony', 'Samsung', 'Amazon', 'Microsoft', 'Amazon', 'Microsoft', 'Apple', 'Ikea', 'Microsoft', 'Amazon', 'Amazon', 'Amazon', 'Apple', 'Ikea', 'Ikea', 'Amazon', 'Microsoft', 'Ikea', 'Apple', 'Microsoft', 'Microsoft', 'Ikea', 'Ikea', 'Tesla', 'Amazon', 'Spotify', 'Amazon'],'Day': ['Glasgow', 'Manchester', 'London', 'Manchester', 'London', 'London', 'Manchester', 'Glasgow', 'Glasgow', 'Manchester', 'London', 'London', 'Glasgow', 'Manchester', 'Glasgow', 'Manchester', 'Glasgow', 'Manchester', 'Manchester', 'Glasgow', 'London', 'Manchester', 'London', 'Glasgow', 'Manchester', 'Manchester', 'Glasgow', 'Glasgow', 'Glasgow', 'London', 'London', 'London', 'Manchester', 'Manchester', 'Glasgow', 'Manchester', 'London', 'Manchester', 'Manchester', 'London', 'London', 'London', 'Manchester', 'Manchester', 'London', 'Glasgow', 'London', 'London', 'Manchester', 'London', 'London', 'Glasgow', 'Glasgow', 'Manchester', 'Glasgow', 'Glasgow', 'Glasgow', 'London', 'Glasgow', 'Glasgow','London', 'Glasgow', 'London', 'Manchester', 'London', 'London', 'Glasgow', 'London', 'London', 'Manchester', 'Manchester', 'Glasgow', 'Manchester', 'Manchester', 'Glasgow', 'London', 'Glasgow', 'Glasgow', 'Manchester', 'London', 'Glasgow', 'Glasgow', 'Glasgow', 'Manchester', 'Manchester', 'Manchester', 'Manchester', 'Glasgow', 'London', 'London','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','Manchester', 'Glasgow', 'Glasgow', 'London', 'Glasgow', 'Manchester', 'Glasgow', 'London', 'London', 'Manchester', 'Glasgow', 'London', 'Manchester', 'Manchester', 'Manchester', 'London', 'Glasgow', 'London', 'London', 'Manchester', 'Glasgow', 'Glasgow', 'Manchester', 'Manchester', 'London', 'London', 'Manchester', 'London', 'London', 'Glasgow', 'Glasgow', 'London', 'Manchester', 'Glasgow', 'Glasgow', 'Glasgow', 'Manchester', 'London', 'Glasgow', 'London', 'Manchester', 'London', 'Glasgow', 'Manchester', 'London', 'Manchester', 'Glasgow', 'Manchester', 'Manchester', 'Glasgow', 'London', 'London', 'London', 'Glasgow', 'Manchester', 'Manchester', 'Manchester', 'London', 'Glasgow', 'Glasgow','London', 'Glasgow', 'London', 'Manchester', 'London', 'London', 'Glasgow', 'London', 'London', 'Manchester', 'Manchester', 'Glasgow', 'Manchester', 'Manchester', 'Glasgow', 'London', 'Glasgow', 'Glasgow', 'Manchester', 'London', 'Glasgow', 'Glasgow', 'Glasgow', 'Manchester', 'Manchester', 'Manchester', 'Manchester', 'Glasgow', 'London', 'London','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London','Manchester','Glasgow','London', 'London', 'London', 'Glasgow', 'London', 'Manchester', 'Manchester', 'Glasgow', 'London', 'London', 'Manchester', 'London', 'Manchester', 'Manchester', 'Manchester', 'Manchester', 'Glasgow', 'Glasgow', 'Manchester', 'Glasgow', 'London', 'Manchester', 'Manchester', 'Glasgow', 'London', 'Glasgow', 'Glasgow', 'London', 'Glasgow', 'Glasgow'],'Test':['B', 'B', 'A', 'B', 'A', 'B', 'B', 'A', 'A', 'B', 'A', 'B', 'A', 'A', 'A', 'B', 'A', 'A', 'A', 'B', 'A', 'A', 'A', 'B', 'A', 'A', 'B', 'A', 'A', 'A', 'A', 'B', 'B', 'A', 'B', 'A', 'B', 'A', 'B', 'B', 'B', 'A', 'B', 'A', 'B', 'B', 'A', 'A', 'B', 'B', 'B', 'A', 'B', 'B', 'A', 'A', 'B', 'B', 'A', 'A','A', 'A', 'A', 'B', 'A', 'B', 'B', 'A', 'B', 'B', 'A', 'B', 'B', 'B', 'B', 'B', 'A', 'A', 'A', 'B', 'B', 'A', 'B', 'B', 'A', 'A', 'A', 'A', 'A', 'A','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B','B', 'B', 'B', 'B', 'B', 'A', 'A', 'A', 'A', 'B', 'B', 'B', 'A', 'A', 'A', 'B', 'A', 'A', 'B', 'A', 'B', 'A', 'B', 'B', 'A', 'A', 'A', 'B', 'B', 'A', 'A', 'A', 'B', 'A', 'B', 'B', 'B', 'A', 'B', 'A', 'A', 'B', 'A', 'A', 'A', 'A', 'B', 'A', 'B', 'B', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'A', 'A', 'A','A', 'A', 'A', 'B', 'A', 'B', 'B', 'A', 'B', 'B', 'A', 'B', 'B', 'B', 'B', 'B', 'A', 'A', 'A', 'B', 'B', 'A', 'B', 'B', 'A', 'A', 'A', 'A', 'A', 'A','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B','B', 'A', 'A', 'B', 'A', 'B', 'B', 'B', 'B', 'A', 'A', 'A', 'B', 'A', 'A', 'A', 'B', 'B', 'A', 'B', 'B', 'A', 'A', 'A', 'B', 'A', 'B', 'A', 'B', 'A','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B','A','B','A','B','A','B','A','B','A','A','B','A','B','A','B']})

df["Date"] = pd.to_datetime(df["Date"], format='%d/%m/%Y')

def heatmap(frame):
    # Bottom,Left,Right,Top

    p = ggplot(frame, aes('Date', 'Site')) + geom_tile(aes(fill='Spend')) \
        + scale_fill_gradientn(colors=['#9ebcda', '#8c6bb1', '#88419d', '#6e016b']) \
        + ggtitle("title") \
        + facet_grid(['Day', 'Test']) \
        + theme(axis_text_x  = element_text(angle = 90, hjust = 1))
    p.save("testo.png")
    return p

heatmap(df)